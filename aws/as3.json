{
	"$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema.json",
	"class": "AS3",
	"action": "deploy",
	"persist": true,
	"declaration": {
		"class": "ADC",
		"schemaVersion": "3.13.0",
		"id": "123abc",
		"label": "Sample 1",
		"remark": "An HTTPS sample application",
		"controls": {
			"trace": true
		},
		"DemoTenant": {
			"class": "Tenant",
			"Shared": {
				"class": "Application",
				"template": "shared"
			},
			"DemoApp": {
				"class": "Application",
				"template": "https",
				"serviceMain": {
					"class": "Service_HTTPS",
					"virtualPort": 8080,
					"virtualAddresses": [
						"0.0.0.0"
					],
					"pool": "${web_pool}",
					"serverTLS": "webtls"
				},
				"${web_pool}": {
					"class": "Pool",
					"monitors": [
						"tcp"
					],
					"members": [{
						"servicePort": 80,
						"addressDiscovery": "consul",
						"updateInterval": 10,
						"uri": "http://10.0.0.100:8500/v1/catalog/service/nginx"
					}]
				},
				"telemetry_local_rule": {
					"remark": "Only required when TS is a local listener",
					"class": "iRule",
					"iRule": "when CLIENT_ACCEPTED {\n  node 127.0.0.1 6514\n}"
				},
				"telemetry_local": {
					"remark": "Only required when TS is a local listener",
					"class": "Service_TCP",
					"virtualAddresses": [
						"255.255.255.254"
					],
					"virtualPort": 6514,
					"iRules": [
						"telemetry_local_rule"
					]
				},
				"telemetry": {
					"class": "Pool",
					"members": [{
						"enable": true,
						"serverAddresses": [
							"255.255.255.254"
						],
						"servicePort": 6514
					}],
					"monitors": [{
						"bigip": "/Common/tcp"
					}]
				},
				"telemetry_hsl": {
					"class": "Log_Destination",
					"type": "remote-high-speed-log",
					"protocol": "tcp",
					"pool": {
						"use": "telemetry"
					}
				},
				"telemetry_formatted": {
					"class": "Log_Destination",
					"type": "splunk",
					"forwardTo": {
						"use": "telemetry_hsl"
					}
				},
				"telemetry_publisher": {
					"class": "Log_Publisher",
					"destinations": [{
						"use": "telemetry_formatted"
					}]
				},
				"webtls": {
					"class": "TLS_Server",
					"certificates": [{
						"certificate": "webcert"
					}]
				},
				"webcert": {
					"class": "Certificate",
					"remark": "in practice we recommend using a passphrase",
					"certificate": "-----BEGIN CERTIFICATE----- ....",
					"privateKey": "-----BEGIN RSA PRIVATE KEY---....",
					"passphrase": {
						"ciphertext": "",
						"protected": ""
					}
				}
			}
		}
	}
}
